stage('test-examples') {              
    if (env.SGX == "1") {
        env.MODE = "sgx"
    }
    else {
        env.MODE = "direct"
    }

    if (os_release_id != "alpine") {
        try {
            timeout(time: 15, unit: 'MINUTES') {
                sh '''
                    cd CI-Examples/pytorch
                    python3 download-pretrained-model.py
                    make ${MAKEOPTS} all
                    gramine-${MODE} ./pytorch ./pytorchexample.py
                '''
            }
        } catch (Exception e) { }
    }
}
